<!DOCTYPE html>
<html>
<head><base target="_top"><title>Dashboard</title></head>
<body>
<h2>Upcoming WFH</h2>
<table border="1" id="wfhTable"><tr><th>Name</th><th>Date</th><th>Status</th></tr></table>

<script>
const urlParams = new URLSearchParams(window.location.search);
const token = urlParams.get('token');

google.script.run.withSuccessHandler(data => {
  const table = document.getElementById("wfhTable");
  data.forEach(r=>{
    const row = table.insertRow();
    row.insertCell(0).innerText = r.name;
    row.insertCell(1).innerText = r.date;
    row.insertCell(2).innerText = r.status;
  });
}).dashboard(token);
</script>
</body>
</html>
