<!DOCTYPE html>
<html>
<head><base target="_top"><title>Request WFH</title></head>
<body>
<h2>Request WFH</h2>
<input id="date" type="date"><br><br>
<button onclick="submitRequest()">Submit</button>
<p id="error" style="color:red;"></p>
<p id="success" style="color:green;"></p>

<script>
const urlParams = new URLSearchParams(window.location.search);
const token = urlParams.get('token');

function submitRequest() {
  const date = document.getElementById("date").value;
  google.script.run.withSuccessHandler(res=>{
    if(res.error) {
      document.getElementById("error").innerText = res.error;
    } else {
      document.getElementById("success").innerText = "Request submitted!";
    }
  }).requestWFH({token, date});
}
</script>
</body>
</html>
