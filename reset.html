<!DOCTYPE html>
<html>
<head><base target="_top"><title>Reset Password</title></head>
<body>
<h2>Reset Password</h2>
<input id="newPassword" type="password" placeholder="New Password"><br><br>
<button onclick="resetPassword()">Submit</button>
<p id="error" style="color:red;"></p>
<p id="success" style="color:green;"></p>

<script>
const urlParams = new URLSearchParams(window.location.search);
const token = urlParams.get('token');

function resetPassword() {
  const newPassword = document.getElementById("newPassword").value;
  google.script.run.withSuccessHandler(res => {
    if(res.error) {
      document.getElementById("error").innerText = res.error;
    } else {
      document.getElementById("success").innerText = "Password reset! Redirecting...";
      setTimeout(()=>window.location.href="index.html", 1500);
    }
  }).resetPassword({token, newPassword});
}
</script>
</body>
</html>
